<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="iso-8859-1">

    <title>Swap plugin for VMD</title>

    <meta name="author" content="Luis Gracia">

    <link rel="stylesheet" href="../html5-reset.css">
    <link rel="stylesheet" href="../vmd.css">
    <link rel="stylesheet" href="swap.css">
  </head>

  <body>
    <div id="container">
      <header>
        <a href="http://physiology.med.cornell.edu/"><img src="http://physiology.med.cornell.edu/images/header.jpg" alt="physiology"/></a>
        <div id="back-main"><a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins">VMD plugins at WMC Physiology &amp; Biophysics</a></div>
        <h1>Swap: swapping coordinates between atoms</h1>
      </header>

      <nav>
        <ul>
          <li><a href="#description">Description</a></li>
          <li><a href="#manual">Manual</a></li>
          <li><a href="#download">Download</a></li>
          <li><a href="#install">Installation</a></li>
          <li><a href="#author">Author</a></li>
        </ul>
      </nav>

      <div id="main">
        <section id="description">
          <header>
            <h1>Description</h1>
          </header>
        <p>The Swap plugin is a set of procedures (no GUI is supplied) to swap coordinates between atoms in a molecule. The development of this plugin started due to the necessity to calculate the best rmsd between two conformations of a molecule that contains symmetric atoms. It has been further developed to allow for more abstract swapping of atoms and to be accessible from other plugins or the command line.</p>
        </section>

        <section id="manual">
          <header>
            <h1>Manual</h1>
          </header>
          <p>The Swap plugin is a tcl command plugin.</p>

          <h2>Procedures</h2>
          <ul>
            <li><b>::swap::swap_list</b> is not a procedure, but an array that holds the definitions of atoms to swap for each residue. In addition, it holds a property called <em>type</em> that can be defined by the user to group set of equivalent atoms, i.e., symmetry atoms in PHE (sym), positions not well identified by XRAY in GLN (xray, or any other label you like to use). The following symmetry atoms are predifined:
              <pre>
PHE {sym CD1 CD2 CE1 CE2}
TYR {sym CD1 CD2 CE1 CE2}
ASP {sym OD1 OD2}
GLU {sym OE1 OE2}
ARG {sym NH1 NH2}
VAL {sym CG1 CG2}</pre>
              <p>For example, <em>PHE</em> has type <em>sym</em> and defined <em>CD1</em> to be equivalent to <em>CD2</em>, and <em>CE1</em> to <em>CE2</em>. The following procedures allow to print, add and delete definitions.</p>
            </li>
            <li><b>::swap::list <em>type</em></b> prints the definitions in <em>::swap::swap_list</em>. If <em>type</em> is used only definitions of the correspoding type will be printed (see <em>::swap::swap_list</em> below for further explanations).</li>
            <li><b>::swap::add <em>resname type atoms o</em></b> adds a definition to <em>::swap::swap_list</em> for <em>resname</em>. <em>atoms</em> is a list of pairs of equivalent atoms to swap the coordinates (enclose the list in brackets, see examples below). <em>o</em> can be set to 1 to force overwrite of definition. See <em>::swap::swap_list</em> below for further explanations.</li>
            <li><b>::swap::del <em>resname</em></b> deletes the entry for <em>resname</em> in <em>::swap::swap_list</em>.</li>
            <li><b>::swap::swap_residue <em>res frame?</em></b> will swap the atoms defined in the <em>::swap::swap_list</em> for the residue contained the in the atomselection <em>res</em> (must match to one single residue in the molecule). <em>Frame</em> is the frame to use when swapping the coordinates (default: <em>now</em>).</li>
            <li><b>::swap::swap_atoms <em>atom1 atom2</em></b> swap two atomselections (each must match to one single atom in the molecule). This proc is called from <em>::swap::swap_residue</em>.</li>
          </ul>
          
          <h2>Examples</h2>
          <ul>
            <li>Activating the plugin (I suggest doing this in your .vmdrc, see <a href="#install">installation instructions</a> below):
              <pre>
package require swap</pre>
            </li>
            <li>Adding and removing definitions:
              <pre>
::swap::list
::swap::add RES equiv {C1 C2 C3 C4}
::swap::list
::swap::list sym
::swap::list equiv
::swap::del RES</pre>
            </li>
            <li>Calculating the best rmsd swapping PHE residues. Load two conformations of the same molecule in mol 0 and mol 1 (the effect will be more clear if you make sure some PHE residues have swapped conformations):
              <pre>
set ref [atomselect 0 "resname PHE"]
set sel [atomselect 1 "resname PHE"]

# Calculate initial rmsd
set rmsd [measure rmsd $ref $sel]
puts "$rmsd"

# For each PHE residue, swap atoms and recalculate rmsd
foreach res [lsort -unique -integer [$sel get resid]] {
   set res_sel [atomselect 1 "resid $res"]
   ::swap::swap_residue $res_sel
   set rmsd2 [measure rmsd $ref $sel]
   puts -nonewline "$res $rmsd $rmsd2"
   # If new rmsd is lower, save it
   if {$rmsd2 < $rmsd} {
      lappend swapped $res_sel
      set rmsd $rmsd2
      puts -nonewline " -- swap"
   } else {
      # revert swap if rmsd was higher
      ::swap::swap_residue $res_sel
   }
   puts ""

   # revert swaps of those residues that produces lower rmsd
   foreach r $swapped {
      ::swap::swap_residue $res_sel
   }
}</pre>
            </li>
          </ul>
          <p>A more complex version of the previous example has been implemented in the <a href="../rmsdtt">rmsdtt plugin</a>, with support for trajectories. Another example to calculate the rmsd by residue using the swapping plugin can be found <a href="swapbyres.tcl">here</a>.</p>
        </section>
        
        <section id="download">
          <header>
            <h1>Download</h1>
          </header>
          <p>Send a mail to the <A HREF="#author">author</A> if you would like to be informed about new updates of this plugin.</p>

          <section class="plugin">
            <header>
              <span>[<a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/swap/versions/swap-v1.0.tgz">download</a>]</span>
              <h1><a name="latest">version 1.0</a> (4 Apr'06)</h1>
            </header>
            <p>Change log:</p>
            <ul>
	      <li>First release</li>
            </ul>
          </section>
        </section>

        <section id="install">
          <header>
            <h1>Installation</h1>
          </header>
          <p>A small guide on how to install third party VMD plugins can be found <a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/installation.html">here</a>. In summary:</p>
            <pre>
set auto_path [linsert $auto_path 0 {/path/to/plugins/directory}]
</pre>
            <p>The Swap plugin should be accessible from the command line after requiring it (see the <a href="">examples section</a>.</p>
        </section>

        <section id="author">
          <header>
            <h1>Author</h1>
          </header>
          <em>Luis Gracia, PhD
            <br/>Weill Cornell Medical College
            <br/>1300 York Ave, New York, 10065 NY</em>

          <p>Send comments and feedback to <a href="mailto:lug2002@med.cornell.edu">Luis Gracia</a>.</p>
        </section>
      </div>

      <footer>
        <span id="copyright">Copyright &copy; 2004-2011, Weill Cornell Medical College. All Rights Reserved</span>
        <address>
          <a href="mailto:lug2002@med.cornell.edu">Luis Gracia</a>
          | last updated: Thursday, August 4 2011
          <!--#config  timefmt="%A %e/%m/%y"--><!--#echo var="LAST_MODIFIED"-->
        </address>
      </footer>
    </div> 
  </body>
</html>
